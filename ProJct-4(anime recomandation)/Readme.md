Project 4 - Anime Recomandation - readme
# ✔ 데이터 선택이유
- 해당데이터는 타겟피쳐가 따로 정의되어 있지 않은 데이터셋으로, 현업에서 사용자들이 무엇을 선호할지 알지못하고 사용자들의 선호도를 예측해야하는 상황에서 도움을 줄 수 있는 경험이 될 것이라 생각했습니다. 또한 애니는 개인의 선호도를 명확하게 구분지을 수 있는 데이터라 생각하여 선호도를 예측하는데 좋은 데이터 셋이 될거라 생각해 선택했습니다.
- 추가적으로 애니 추천과 비슷하게 어떠한 물품이나, 서비스, 등과 같은 사용자의 선호도를 예측하여 추천을 해야하는 직무에 도움이 될것이라 생각하여 선택하게 되었습니다.

# 📁 데이터 정보
## 출처
- https://www.kaggle.com/hernan4444/anime-recommendation-database-2020?select=watching_status.csv

## 🔎 소개
- 17.562개의 애니에 대한 정보와 325.772명의 다른 사용자가 선호하는 정보가 포함되어 있습니다.

## 📌 특이점
- 이 데이터 세트에는 성인용 애니(헨타이)에 대한 정보가 포함되어 있습니다.

## 🗂 콘텐츠
### 📄 animelist.csv
- 사용자가 각 점수와 함께 등록한 모든 애니 목록, 시청 현황 및 시청 회수
- 사용자별 애니 목록입니다. 중단, 완료, 시청 계획, 현재 시청 및 보류를 포함합니다.

### 📄 watching_status.csv
- animelist.csv의 watching_status에 해당하는 시청상태를 설명

### 📄 rating_complete.csv
- 사용자가 watching_status==2(완료)를 가진 애니에 부여한 등급 목록을 포함하는 CSV
- 사용자가 완전히 본 애니에 대해 부여한 등급입니다.

### 📄 anime_with_synopsis.csv
- 장르 열에 Hentai가 포함되지 않은 애니 개요가 포함된 CSV

### 📄 anime.csv 
- 모든 애니에 대한 일반 정보를 포함합니다.
- 장르, 통계, 스튜디오 등과 같은 애니에 대한 정보
 

## ⁉ 확인해볼만한 사항
### 데이터 확인 및 분석
- Popularity를 기준으로 상위 데이터를 나누고, 범주형 데이터들을 시각화를 해서 데이터를 분석함

### 가설
- 사용자들이 비슷한 내용을 좋아한다면, 시놉시스를 통해 비슷한 내용을 갖는 애니를 추천하면 좋을것이다.

- 상위데이터들의 시각화자료들을 분석하여 도출된 결과들은 모델로 예측한 값과 비슷할 것이다.

#  🖥 데이터 확인 및 분석
## 🔍 데이터 확인
- Dataframe의 각 칼럼들의 데이터타입 확인 및 .head()를 통한 데이터의 가시적인 확인
- 클리닝진행
  - 중복값 확인
  - 카디널리티 줄이기
  -  피쳐엔지니어링 및 피쳐셀렉션

## 🔍 데이터 분석
- Popularity를 기준으로 상위 1000, 5000에 해당하는 데이터를 분류하여 전체 데이터와 비교하는 형식으로 분석을 진행!

### Rating
<img width="458" alt="스크린샷 2021-08-12 오후 3 14 43" src="https://user-images.githubusercontent.com/73811590/129147056-cb7cb29c-7854-4934-b921-f9d8022dead2.png">

- 첫째 
  - ['PG-13 - Teens 13 or older'] 가 상위데이터 뿐만 아니라 전체데이터에서도 가장 많이 보입니다. 총 애니 중 절반이상이 해당 레이팅을 가지고 있는 것으로 보아 레이팅을 중심으로 추천하는 것은 적절하지 않지만, 이 레이팅에 해당하는 애니를 추천하면 높은 확률로 사용자가 선호할 수 있음을 의미합니다.

- 둘째
  - 1k,5k에서는 레이팅의 상위 3개가 동일하지만, 전체데이터에서 나타나는 레이팅에서는 상이한것을 통해 만18세 이상에 해당하는 애니는 연령제한으로 인해 접근이 용이하지 않아서 그런것으로 해석될 여지가 있으며, 연령제한에 걸리지 않는 사용자 중 해당 레이팅을 가진 애니에 좋은 점수 혹은 시청을 완료한것과 같은 정보가 존재한다면 해당 레이팅을 가진 애니를 추천했을때 사용자가 선호할 확률이 긍정적일 수 있다는 것으로 사료된다.
 
- 정리
  - 13세 이상 관람가가 전체적으로 많지만, 18세이상/성인관람가 또한 상위랭크에 있었음을 통해 13세 이상 관람가 이상의 레이팅이면 흥행할 수 있는 가능성이 많다
  
### Source
<img width="450" alt="스크린샷 2021-08-12 오후 3 14 28" src="https://user-images.githubusercontent.com/73811590/129147027-7677b5b2-031a-43f2-ab3e-4bb11773279a.png">

- 첫째
  - 애니가 원작인 애니가 제작량은 가장 많지만, 만화책을 원작으로 하는 애니가 상위 데이터에서 더 높은 순위를 차지하고 있는것을 확인할 수 있으며, 이를 통해 만화책을 원작으로 하는 애니를 사용자들이 더 선호함을 확인할 수 있다.

- 둘째
  - 단편소설을 원작으로 하는 애니는 6번째 제작량에 위치하는것과 상위 데이터에서 2,3번째에 해당하는 것으로보아 제작량 대비 흥행하는 퍼센트가 높아서 사용자들에게 추천하면 긍정적인 반응이 올 것이라 분석할 수 있다.

- 정리
  - 애니가 원작인 애니가 보편적이지만, 만화와 단편소설을 원작으로 하는 애니가 흥행성이 높고, 선호도가 높을 확률이 높다
 
### Type
<img width="462" alt="스크린샷 2021-08-12 오후 3 15 37" src="https://user-images.githubusercontent.com/73811590/129147146-3f9b3c8d-731a-4cf1-a8c4-8792afd6dda9.png">

- 첫째
  - TV가 가장 많으며 상위 데이터셋에서도 가장 많은 비중을 차지하고 있다. 시리즈 형태의 애니로 한 회를 보기 시작하면 이후 회차까지 봐야해서 사용자들이 꾸준하게 이용이 가능하다는 특징을 통해 첫회가 긍정적인 추천이라는 생각이 들면 사용자들이 끝회차 까지 보게되는 장점이 존재한다.
- 둘째
  - 1k에서 Movie의 순위와 다른 데이터셋에서 3번째에 존재한다는 점을 통해서 시리즈 형태가 아닌, 영화형태의 애니가 흔히 말하는 well-made인 경우, 적게 제작되더라도 10%이상의 작품들이 흥행에 성공할 수 있다는 분석이 가능하다 따라서 영화형태의 애니 중 사용자들에게 긍정적인 선호도가 존재하는 영화라면 사용자들에게 추천하면 좋을 것이라 판단된다.
- 정리
  - TV가 보편적인 선호도를 가지지만 영화애니도 작품성이 높다면 선호될 수 있는 가능성이 있다 
### Studios
<img width="462" alt="스크린샷 2021-08-12 오후 3 15 54" src="https://user-images.githubusercontent.com/73811590/129147175-c233eab2-ed6b-4c47-9dd3-94fce31259b8.png">

- 첫째
  - 전체데이터는 해당 스튜디오가 제작한 애니의 숫자를 알 수 있다면, 이를 통해 1k, 5k에서는 제작한 애니 대비 성공적으로 유명해진 애니의 숫자를 알 수 있다. 따라서 전체데이터에서만 보이는 스튜디오를 제외하고 사용자에게 추천한다면 사용자가 해당 애니를 선호하는데 최소한의 제작에 대한 퀄리티를 보장할 수 있을 것이라 사료됩니다.
- 둘째
  - 첫째에서 언급한것처럼 모든 데이터셋에서 중복적으로 보여지는 스튜디오 중 제작애니의 수가 적지만, 1k,5k에서 높은 순위를 가지고 있는 스튜디오가 애니의 질을 높게 제작하고 있음을 알 수 있다 따라서, ['J.C.Staff', 'Madhouse']에서 제작된 애니의 경우 타 스튜디오에서 제작된 애니보다 선호할 확률이 높을 것이라 분석된다.
- 정리
  - 전체데이터와 상위데이터를 비교했을때 해당 제작사의 애니가 선호되는 비율을 상대적으로 확인이 가능했는데, 제작량이 적지만 1k,5k에서 상위랭크된 ['J.C.Staff', 'Madhouse'] 제작사의 애니가 선호될 가능성이 높다

### Licensors
<img width="466" alt="스크린샷 2021-08-12 오후 3 16 08" src="https://user-images.githubusercontent.com/73811590/129147195-dde514b4-0841-491c-9a99-895db0af394e.png">

- 첫째
  - 대형 라이선서가 대부분의 애니에 대한 라이선스를 가지고 있으며, 상위 데이터에서도 그러한 모습이 나타난느 것으로 보아 대형 라이선서의 애니 중 쌍위 데이터에 있는 애니를 추천하는 것이 보편적인 선호에 합당한 추천으로 사료된다.
- 둘째
  - 전체데이터에서 보여지지 않는 라이선서가 1k,5k에서 중복적으로 나타난다면, 해당 라이선서는 선택적으로 흥행할 수 있는 애니의 라이선스를 가지려고 한다라는 점을 알 수 있다. 따라서, 사용자가 그 라이선스의 애니에 높은 점수를 주었거나 긍정적인 표시를 한경우 해당 라이선서의 애니를 추천하는 것이 대형 라이선서의 애니를 추천하는 것보다, 긍정적인 선호를 끌어낼 수 있음을 의미한다.
- 정리
  - 거대라이선서가 대부분의 라이선서를 가지고 있지만 "스튜디오"와 마찬가지로 전체데이터셋에서 보이지 않은 라이선서가 상위데이터셋에서 보이면 해당 라이선서의 애니가 작품성이있고 흥행성이 있기때문에 선호도가 높을것이라 분석할 수 있다

### Genres
<img width="460" alt="스크린샷 2021-08-12 오후 3 16 22" src="https://user-images.githubusercontent.com/73811590/129147216-00dbae6f-8c48-4641-860a-8f7bfe9c03a7.png">

- 첫째
  - 코미디와 액션을 포함하는 애니가 가장 인기가 많은 장르로 분석된다.
- 둘째
  - 상위1000개의 애니에서는 로맨스와 판타지, 슈퍼내츄럴이 다음을 이어가지만 다른 데이터에서 판타지, 드라마, 로맨스가 이어지는 것으로 보아 본편적으로 로맨스와 판타지가 섞여있을 경우 사용자들의 선호도가 높을 수 있음을 알 수 있다.
- 정리
  - 전체적으로 코미디와 액션이 우세적으로 보이며 시각화 자료줄 특이점은 1k데이터셋의 상위 장르 순서가 로맨스가 앞에 있다는 점인데, 액션코미디를 중심으로 적절한 로맨스를 가미한 판타지적인 애니가 주로 선호된다라는 것을 알 수 있었습니다.

# 모델링
- 모델링을 기획 중 어려움에 부딪혀 ML(머신러닝)을 구현하고 학습시켰지만 성능이 좋지않아서 삭제 후 캐글의 모델을 구현하고 주석을 통해 모델을 분석헤보는 것으로 모델링을 함.

## 🤖 DL(딥러닝)

### 🏗 모델빌드
- RecommenderNet

Model: "model_2"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
user (InputLayer)               [(None, 1)]          0                                            
__________________________________________________________________________________________________
anime (InputLayer)              [(None, 1)]          0                                            
__________________________________________________________________________________________________
user_embedding (Embedding)      (None, 1, 128)       39687552    user[0][0]                       
__________________________________________________________________________________________________
anime_embedding (Embedding)     (None, 1, 128)       2159616     anime[0][0]                      
__________________________________________________________________________________________________
dot_product (Dot)               (None, 1, 1)         0           user_embedding[0][0]             
                                                                 anime_embedding[0][0]            
__________________________________________________________________________________________________
flatten_2 (Flatten)             (None, 1)            0           dot_product[0][0]                
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            2           flatten_2[0][0]                  
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 1)            4           dense_2[0][0]                    
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 1)            0           batch_normalization_2[0][0]      
==================================================================================================
Total params: 41,847,174
Trainable params: 41,847,172
Non-trainable params: 2
__________________________________________________________________________________________________

### 모델 콜백
- LearningRateScheduler
- ModelCheckpoint
- EarlyStopping

### 모델학습
#### train, val
Epoch 1/20 - 1831s 529ms/step - loss: 0.6794 - mae: 7.0071 - mse: 52.0233 - val_loss: 0.5567 - val_mae: 7.0039 - val_mse: 51.9765

Epoch 2/20 - 1815s 525ms/step - loss: 0.2996 - mae: 6.9968 - mse: 51.8632 - val_loss: 0.1307 - val_mae: 6.9913 - val_mse: 51.7946

.
.
.

Epoch 20/20 - 1840s 532ms/step - loss: -13.2967 - mae: 6.7845 - mse: 48.2092 - val_loss: -12.7269 - val_mae: 6.7816 - val_mse: 48.3166

- 시각화
  <img width="408" alt="스크린샷 2021-08-12 오후 1 41 49" src="https://user-images.githubusercontent.com/73811590/129139202-999fde4a-6831-4b66-ae25-866e4cd77ff6.png">

#### test
  - evaluate
  - 1153/1153 [==============================] - 10s 8ms/step - loss: -12.7224 - mae: 6.7814 - mse: 48.3153

# 📈 모델활용
## sypnopsis Base Recommendation
- 애니명을 인자로 받아 비슷한 애니를 추천하기
## User Based Recommendation
- user_id를 매개변수로 받아서 해당 유저의 기록 중 일정 등급이상의 기록을 가져와 시청한 애니의 장르들을 말풍선화 하고, 목록화 하기
- 비슷한 취향의 유저들을 매개변수로 받아 해당 유저들의 정보를 기반으로 장르말풍선, 선호애니 리스트를 반환하기
## Ranking based Recommendation
- 아직 보지 않은 애니 중 상위레이팅인 애니들을 추천함
