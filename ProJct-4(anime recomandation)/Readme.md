Project 4 - Anime Recomandation - readme
# ✔ 데이터 선택이유
해당데이터는 타겟피쳐가 따로 정의되어 있지 않은 데이터셋으로, 현업에서 사용자들이 무엇을 선호할지 알지못하고 사용자들의 선호도를 예측해야하는 상황에서 도움을 줄 수 있는 경험이 될 것이라 생각했습니다. 또한 애니는 개인의 선호도를 명확하게 구분지을 수 있는 데이터라 생각했습니다.
추가적으로 애니 추천과 비슷하게 어떠한 물품이나, 서비스, 등과 같은 사용자의 선호도를 예측하여 추천을 해야하는 직무에 도움이 될것이라 생각하여 선택하게 되었습니다.

#  📁 데이터 정보
- 출처: https://www.kaggle.com/hernan4444/anime-recommendation-database-2020?select=watching_status.csv

## 🔎 소개
17.562개의 애니에 대한 정보와 325.772명의 다른 사용자가 선호하는 정보가 포함되어 있습니다.

## 📌 특이점
이 데이터 세트에는 성인용 애니(헨타이)에 대한 정보가 포함되어 있습니다.

## 🗂 콘텐츠
### 📄 animelist.csv
- 사용자가 각 점수와 함께 등록한 모든 애니 목록, 시청 현황 및 시청 회수
- 사용자별 애니 목록입니다. 중단, 완료, 시청 계획, 현재 시청 및 보류를 포함합니다.

### 📄 watching_status.csv
- animelist.csv의 watching_status에 해당하는 시청상태를 설명

### 📄 rating_complete.csv
- 사용자가 watching_status==2(완료)를 가진 애니에 부여한 등급 목록을 포함하는 CSV
- 사용자가 완전히 본 애니에 대해 부여한 등급입니다.

### 📄 anime_with_synopsis.csv
- 장르 열에 Hentai가 포함되지 않은 애니 개요가 포함된 CSV

### 📄 anime.csv 
- 모든 애니에 대한 일반 정보를 포함합니다.
- 장르, 통계, 스튜디오 등과 같은 애니에 대한 정보
 

## ⁉ 확인해볼만한 사항
### 🧑‍💻 데이터 확인 및 분석
- Popularity를 기준으로 상위 데이터를 나누고, 범주형 데이터들을 시각화를 해서 데이터를 분석함

### 🧑‍💻 가설
- 사용자들이 비슷한 내용을 좋아한다면, 시놉시스를 통해 비슷한 내용을 갖는 애니를 추천하면 좋을것이다.

- 상위데이터들의 시각화자료들을 분석하여 도출된 결과들은 모델로 예측한 값과 비슷할 것이다.

#  🖥 데이터 확인 및 분석
## 데이터 확인
- Dataframe의 각 칼럼들의 데이터타입 확인 및 .head()를 통한 데이터의 가시적인 확인
- 클리닝진행
  - 중복값 확인
  - 카디널리티 줄이기
  -  피쳐엔지니어링 및 피쳐셀렉션

## 데이터 분석
- Popularity를 기준으로 상위 1000, 5000에 해당하는 데이터를 분류하여 전체 데이터와 비교하는 형식으로 분석을 진행
- Rating, Source, Type, Studios, Licensors, Genres를 확인함

# 모델링
- 모델링을 기획 중 어려움에 부딪혀 ML(머신러닝)을 구현하고 학습시켰지만 성능이 좋지않아서 삭제 후 캐글의 모델을 구현하고 주석을 통해 모델을 분석헤보는 것으로 모델링을 함.

## DL(딥러닝)

### 모델빌드
- RecommenderNet

Model: "model_2"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
user (InputLayer)               [(None, 1)]          0                                            
__________________________________________________________________________________________________
anime (InputLayer)              [(None, 1)]          0                                            
__________________________________________________________________________________________________
user_embedding (Embedding)      (None, 1, 128)       39687552    user[0][0]                       
__________________________________________________________________________________________________
anime_embedding (Embedding)     (None, 1, 128)       2159616     anime[0][0]                      
__________________________________________________________________________________________________
dot_product (Dot)               (None, 1, 1)         0           user_embedding[0][0]             
                                                                 anime_embedding[0][0]            
__________________________________________________________________________________________________
flatten_2 (Flatten)             (None, 1)            0           dot_product[0][0]                
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            2           flatten_2[0][0]                  
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 1)            4           dense_2[0][0]                    
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 1)            0           batch_normalization_2[0][0]      
==================================================================================================
Total params: 41,847,174
Trainable params: 41,847,172
Non-trainable params: 2
__________________________________________________________________________________________________

### 모델 콜백
- LearningRateScheduler
- ModelCheckpoint
- EarlyStopping

### 모델학습
- train, val
Epoch 1/20
3458/3458 [==============================] - 1831s 529ms/step - loss: 0.6794 - mae: 7.0071 - mse: 52.0233 - val_loss: 0.5567 - val_mae: 7.0039 - val_mse: 51.9765
Epoch 2/20
3458/3458 [==============================] - 1815s 525ms/step - loss: 0.2996 - mae: 6.9968 - mse: 51.8632 - val_loss: 0.1307 - val_mae: 6.9913 - val_mse: 51.7946
.
.
.
Epoch 20/20
3458/3458 [==============================] - 1840s 532ms/step - loss: -13.2967 - mae: 6.7845 - mse: 48.2092 - val_loss: -12.7269 - val_mae: 6.7816 - val_mse: 48.3166
  - 시각화
  <img width="408" alt="스크린샷 2021-08-12 오후 1 41 49" src="https://user-images.githubusercontent.com/73811590/129139202-999fde4a-6831-4b66-ae25-866e4cd77ff6.png">

- test
  - evaluate
  - 1153/1153 [==============================] - 10s 8ms/step - loss: -12.7224 - mae: 6.7814 - mse: 48.3153

# 모델활용
## sypnopsis Base Recommendation
- 애니명을 인자로 받아 비슷한 애니를 추천하기
## User Based Recommendation
- user_id를 매개변수로 받아서 해당 유저의 기록 중 일정 등급이상의 기록을 가져와 시청한 애니의 장르들을 말풍선화 하고, 목록화 하기
- 비슷한 취향의 유저들을 매개변수로 받아 해당 유저들의 정보를 기반으로 장르말풍선, 선호애니 리스트를 반환하기
## Ranking based Recommendation
- 아직 보지 않은 애니 중 상위레이팅인 애니들을 추천함
